[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Nguyen‚Äôs Note book",
    "section": "",
    "text": "Preface\nThis is a Quarto book."
  },
  {
    "objectID": "sea_force.html",
    "href": "sea_force.html",
    "title": "1¬† Seasonal forcing model",
    "section": "",
    "text": "2 Overview\nAim of this section:\nArthur Ransome settled on changes in the density of susceptibles as the most likely explanation for mechanisms that may generate regular epidemics of measles, whooping cough, and smallpox.\nExanthematous diseases wipe out nearly all susceptibles and, as a consequence, must necessarily wait a number of years before the requisite nearness of susceptible individuals has been again secured.\nCase report data for measles, which conforms well to the assumptions of the SIR model, show large amplitude recurrent epidemics with very dramatic peaks and troughs.\n=&gt; This is in direct contrast to the equilibrium dynamics predicted by simple models, with a steady incidence of disease.\nThese studies started with the work of (Soper 1929),(Bartlett 1956), and (Bailey 1975), who incorporated seasonality in SIR models with the primary aim of establishing the amplitude of variation in contact rates necessary to produce the observed 80% fluctuation in epidemics.\nIt is often difficult to consider the forcing of childhood infections without considering age structured models. Throughout this chapter, age structure is ignored for simplicity\n(Bailey 1975) explored a simplified SIR model:\n\\[\\frac{dX}{dt} =  \\mu N - \\beta(t) X Y/N \\]\n\\[\\frac{dY}{dt} =  \\beta(t) X Y/N - \\gamma Y \\] where:\nThe transmission rate is a function of time, Œ≤(t), and was taken by Bailey to be a sinusoid:\n\\[\\beta(t) = \\beta_{0}(1+\\beta_{1}cos(\\omega t))\\]\nwhere:\nCode\nojsdata = transpose(data)\n\nviewof beta_0 = Inputs.range(\n  [1, 5], \n  {value: 1, step: 1, label: \"beta_0\"}\n)\n\n\nviewof omega = Inputs.radio(\n    [6.28, 4.1867, 3.1400, 2.5120, 2.0933], \n    {value:6.28,label: \"Omega\"})\n\nviewof beta_1 = Inputs.range(\n  [0.5, 5], \n  {value: 0.5, step: 0.5, label: \"beta_1\"}\n)\n\nojsdata_filtered = ojsdata.filter(function(circle){\n  return circle.beta_0 == beta_0 & circle.beta_1 == beta_1 & circle.omega == omega})\nCode\nPlot.plot({\n  y: {grid: true, label: \"Beta\"},\n  marks: [\n    Plot.lineY(ojsdata_filtered, {x: \"t\", y: \"beta\", stroke: \"steelblue\"}),\n    Plot.lineY(ojsdata_filtered, {x: \"t\", y: \"beta_0\", stroke: \"red\"})\n  ]\n})\nTo explore the dynamics of small perturbations to the unforced equilibrium, Bailey made substitutions \\(X = X‚àó(1 + x)\\) and \\(Y = Y ‚àó(1 + y)\\), after omitting some intermediate steps, gives a second order differential equation in the small infectious perturbation y:\n\\[\\frac{d^{2}y}{dt^{2}}+\\mu R_{0} \\frac{dy}{dt}+\\mu \\beta y = -\\beta_{1} \\omega \\gamma sin(\\omega t)\\]\nThe period of the oscillations is the same as the period of the forcing, the amplitude of oscillations (M):\n\\[M = \\beta_{1}\\omega \\gamma \\{(\\mu \\beta_{0}-\\omega^{2})^{2} + (\\omega \\mu R_{0})^{2}\\}^{-\\frac {1}{2}} \\]\nMaking the appropriate substitutions for measles, we set \\(\\frac{1}{\\gamma} = 2\\), \\(\\mu R_{0} \\sim 0.014\\) and \\(\\omega = \\frac{\\pi}{26}\\) (taking the week as our basic time unit) =&gt; \\(M \\sim 7.76 \\beta_{1}\\) ( 10% variation in the transmission parameter translates into seasonal variations of 78% in case notifications)\nButterfly effect: ‚ÄúA butterfly flaps its wings in the Amazon rainforest, and subsequently a hurricane forms in Texas,‚Äù\nüìå Relatively modest levels of variation in the transmission rate can translate into large amplitude fluctuations in the observed disease incidence\nThe condition for growth of disease incidence is:\n\\[\\begin{align}\n\\frac {dY}{dt} &= \\beta X \\frac {Y}{N} - (\\gamma + \\mu) Y &gt; 0 \\\\\n&= Y (\\gamma + \\mu) (R_{0}\\frac{X}{N}-1) &gt;0   \\\\\n&\\Rightarrow \\frac{X}{N} &gt;\\frac{1}{R_{0}} \\approx \\frac{\\gamma}{\\beta}\n\\end{align}\\]\nThe spread only occur when a sufficient fraction of susceptible higher a critical value determined by \\(R_{0}\\)\nüìå The amplitude of seasonality increases =&gt; larger epidemics are generated (lower the level of susceptibles such that recovery to above the threshold takes far longer, resulting in longer period cycles)\nWe‚Äôve explored seasonality by assuming that the transmission rate is time dependent and specifically is determined by a simple sinusoidal function, this view has changed in recent years:\n\\[\\beta(t)=\\beta_{0}(1+b_{1}Term(t))\\]\nwhere:\nWe obtain 92 school holidays , 273 days of school =&gt; many more ‚Äú+1‚Äù days than ‚Äú‚àí1‚Äù days =&gt; give rise to a mean transmission rate averaged over the year. To ensure R0 is constant irrespective of the precise forcing function used and the amplitude of seasonality. If there are \\(D+\\) days of school and \\(D‚àí\\) holidays, then our forcing function would be:\n\\[\\beta(t)=\\frac{\\beta_{0}}{\\frac{1}{365}((1+b_{1})D_{+}+(1-b_{1})D_{-})}(1+b_{1}Term(t))\\]\nCode\nlibrary(odin2)\nlibrary(dust2)\nlibrary(tidyverse)\nlibrary(latex2exp)\n\nbeta_0 &lt;- 1250\nbeta_1 &lt;- 0.25\nt &lt;- seq(0,365,le = 1001)\n\n## sinusoidal function\nomega &lt;- (2*pi)/365\nbeta_sin_func &lt;- data.frame(x = t,\n                            y = beta_0*(1 + beta_1*cos(omega*t)))\n\n## term time tranmission function\n\nschools_time &lt;- c(0, 7, 100, 116, 200, 252, 300,308,356)\nschools_open &lt;- c(-1, 1, -1, 1,   -1,   1,   -1, 1,-1)\n\nbeta &lt;- approx(\n  schools_time,\n  beta_0*(1 + beta_1*schools_open),\n  xout = t,\n  method = \"constant\",\n  rule = 2)\n\n## correct term time tranmission function\nmean_beta &lt;- 1/365*((1+beta_1)*273+(1-beta_1)*92)\n\nbeta_correct &lt;- approx(\n  schools_time,\n  beta_0/mean_beta*(1 + beta_1*schools_open),\n  xout = t,\n  method = \"constant\",\n  rule = 2)\nüìå This discrepancy highlights the need for extra biological detail: A more realistic distribution for the latent and infectious periods or including age structure greatly reduces the error associated with term-time forcing."
  },
  {
    "objectID": "sea_force.html#soper-study",
    "href": "sea_force.html#soper-study",
    "title": "1¬† Seasonal forcing model",
    "section": "3.1 Soper study",
    "text": "3.1 Soper study\nFocusing on the monthly case reports for measles in Glasgow from 1905‚Äì1916, (Soper 1929)proceeded to estimate relative transmission rates per month. His methodology centered on the argument that:\n\\[\\frac{cases\\ this\\ interval}{cases\\ last\\ interval} \\sim \\frac {Number\\ of\\ susceptibles\\ now}{Equilibrium\\ number\\ of\\ susceptibles'} \\] which can be expressed as the following equation:\n\\[(\\frac{C_{t+1}}{C_{t}})^{\\alpha}=k_{\\theta}\\frac{X_{t+1}}{X^{*}}\\] Where:\n\n\\(\\alpha\\): realistic infection(the sum of the infectious and latent periods), \\(\\alpha\\) = 0.2\n\\(k_{0}\\): the factor representing the influence of season \\(\\theta\\)\n\\(X_{*}\\): mean number of susceptibles, equivalent to 70 week‚Äôs cases reports\nAt the peak of an epidemic, \\(C_{t+1} \\sim C_{t}\\),we have an initial estimate for \\(X_{t+1}\\), which can be updated by adding the documented births and subtracting the number of cases\n\n=&gt; All that remains now is to fit the seasonality parameter \\(k_{\\theta}\\)\n\n=&gt; Estimated transmission was very low in the summer months, and peaked dramatically in the early autumn (October)."
  },
  {
    "objectID": "sea_force.html#london-and-yorke-study",
    "href": "sea_force.html#london-and-yorke-study",
    "title": "1¬† Seasonal forcing model",
    "section": "3.2 London and Yorke study",
    "text": "3.2 London and Yorke study\n(London and Yorke 1973) interested in exploring seasonal influences on transmission, and estimated the mean monthly transmission rates for measles, mumps, and chickenpox in New York City from 1935 to 1972. Key concept:\n\nNumber of susceptibles (\\(X_{p}\\)) has the same value at the peak of every outbreak\nThe number of infectious individuals (Y) has reached its maximum, therefore \\(\\frac{dY}{dt} = 0\\)\n\n\\[\\frac{dY}{dt} = 0 =&gt; \\beta XY/N - \\gamma Y = 0 =&gt; X=X_{p} = \\frac{\\gamma N}{\\beta}\\]\nAt the start of the epidemic year, the number of susceptibles = \\(X_{p}\\) + cumulative number of reported cases for that year.\nThen, by using a discrete-time model, they were able to explore the pattern of transmission rates that provided model exposures consistent with the observed case reports.\n=&gt; They also found a clearly seasonal pattern of transmission for all three diseases, with a peak that coincided with the start of school terms in the autumn and a trough that occurred during the summer months"
  },
  {
    "objectID": "sea_force.html#more-later-studies",
    "href": "sea_force.html#more-later-studies",
    "title": "1¬† Seasonal forcing model",
    "section": "3.3 More later studies",
    "text": "3.3 More later studies\nSince then, more mechanistic approaches for the estimation of transmission rates have been developed, which involve a more detailed ‚Äúreconstruction‚Äù of the number of susceptibles in the population.\nFirst (Fine and Clarkson 1982) and later (Finkenst√§dt and Grenfell 2000)used used case report data for measles in England and Wales, together with information on the population size and birth rates to estimate transmission rates.\nüìå A range of statistical approaches have revealed that transmission of childhood infections varies seasonally, peaking at the start of the school year and declining significantly in the summer months."
  },
  {
    "objectID": "sea_force.html#dynamical-consequences-of-seasonality-harmonic-and-subharmonic-resonance",
    "href": "sea_force.html#dynamical-consequences-of-seasonality-harmonic-and-subharmonic-resonance",
    "title": "1¬† Seasonal forcing model",
    "section": "4.1 Dynamical Consequences of Seasonality: Harmonic and Subharmonic Resonance",
    "text": "4.1 Dynamical Consequences of Seasonality: Harmonic and Subharmonic Resonance\nThe first systematic examination of seasonality affecting the dynamical pattern of epidemics was made by Klaus Dietz. Dietz carried out a stability analysis of the familiar SIR model:\n\\[\\frac{dX}{dt} =  \\mu N - (\\beta(t) \\frac {Y}{N} + \\mu) X\\]\n\\[\\frac{dY}{dt} =  \\beta(t) X \\frac {Y}{N} - (\\mu + \\gamma) Y \\]\nwhere \\(\\beta(t) = \\beta_{0}(1-\\beta_{1}cos(\\omega t))\\) ( he used a minus sign in his formulation in order to ensure that contact rates were at their lowest at the start of the epidemic year)\n\n\nCode\ncurve(1*(1 - 0.5*cos(2*pi*time)), 0, 6,\n      n = 1001, xname = \"time\", xlab = \"Time\", ylab = \"Transmission rate\")\n\n\n\n\n\nHe demonstrated that in the absence of seasonal forcing, the system fluctuated with frequency F:\n\\[F^{2} = \\mu (\\gamma + \\mu)(R_{0}-1) - (\\frac{\\mu R_{0}}{2})^{2}\\]\nin many realistic situation \\(\\mu R_{0} \\ll 1\\). Dietz pointed out that for cases in which the natural period of oscillations in the SIR model are approximately the same as that of the seasonal forcing (i.e., F ‚âà œâ), we observe harmonic resonance, where model dynamics mimic those of the forcing, although the amplitude of oscillations may be greatly increased.\nFor different ratios of \\(\\frac {\\omega}{F}\\), however, it is possible for forcing to excite sub-harmonic resonance that gives rise to oscillations with a longer period than the period of the forcing. This phenomenon can occur whenever the natural period of the oscillations \\(\\frac {1}{F}\\) is close to an integer multiple of the period of the forcing \\(\\frac {1}{\\omega}\\)\n\nüìå Forcing is most greatly amplified when the forcing period is close to the natural oscillatory frequency of the unforced dynamics."
  },
  {
    "objectID": "sea_force.html#how-the-amplitude-of-seasonality-affects-dynamics",
    "href": "sea_force.html#how-the-amplitude-of-seasonality-affects-dynamics",
    "title": "1¬† Seasonal forcing model",
    "section": "4.2 How the amplitude of seasonality affects dynamics",
    "text": "4.2 How the amplitude of seasonality affects dynamics\nChanges in either \\(R_{0}\\) or \\(\\beta_{1}\\) can lead to qualitatively different epidemic patterns:\n\nTop left: \\(R_{0}\\) is large, level of seasonal forcing is small =&gt; fraction of infecteds (small-amplitude annual epidemics)\nMiddle left: \\(\\beta_{1} = 0.1\\) =&gt; we observe subharmonic resonance (as \\(\\omega\\) \\(\\approx\\) 2F), biennial dynamics\nBottom left: a further increase in \\(\\beta_{1}\\) =&gt; four-year cycles\nSecond and third columns: \\(R_{0}\\) is smaller, increases in seasonal amplitude =&gt; do not influence the period of epidemics (remain annual), but alter the magnitude of oscillations\n\n\nüìå In the absence of seasonal forcing, the SIR family of models exhibit a stable equilibrium. The introduction of time-dependent transmission rates can generate a variety of dynamical patterns‚Äîdepending on parameter values‚Äîranging from simple annual epidemics to multiennial outbreaks and eventually chaos."
  },
  {
    "objectID": "sea_force.html#seasonal-forcing-model-with-odin2",
    "href": "sea_force.html#seasonal-forcing-model-with-odin2",
    "title": "1¬† Seasonal forcing model",
    "section": "6.1 Seasonal forcing model with odin2",
    "text": "6.1 Seasonal forcing model with odin2\n\n\nCode\nschools_time &lt;- c(0, 7, 100, 116, 200, 252, 300,308,356)\nschools_open &lt;- c(-1, 1, -1, 1,   -1,   1,   -1, 1,-1)\n\nsis &lt;- odin({\n    deriv(S) &lt;- -beta * I * S / N + gamma * I\n    deriv(I) &lt;-  beta * I * S / N - gamma * I\n    deriv(trans_rate) &lt;-  beta \n    \n    initial(S) &lt;- N - I0\n    initial(I) &lt;- I0\n    initial(trans_rate) &lt;-  beta \n    \n    I0 &lt;- parameter(10)\n    N &lt;- parameter(1000)\n    schools &lt;- interpolate(schools_time, schools_open, \"constant\")\n    schools_time &lt;- parameter(constant = TRUE)\n    schools_open &lt;- parameter(constant = TRUE)\n    dim(schools_time, schools_open) &lt;- parameter(rank = 1)\n    beta0 &lt;- parameter(0.125)\n    beta_1 &lt;- parameter(0.025)\n    beta &lt;- beta0*(1 + beta_1*schools)\n    gamma &lt;- 0.1\n})\n\n\n‚îÄ‚îÄ R CMD INSTALL ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\n* installing *source* package 'odin.systemaa6f1137' ...\n** using staged installation\n** libs\nusing C++ compiler: 'G__~1.EXE (GCC) 13.2.0'\ng++ -std=gnu++17  -I\"C:/PROGRA~1/R/R-44~1.3/include\" -DNDEBUG  -I'D:/C√° nh√¢n/note_book_web/renv/library/windows/R-4.4/x86_64-w64-mingw32/cpp11/include' -I'D:/C√° nh√¢n/note_book_web/renv/library/windows/R-4.4/x86_64-w64-mingw32/dust2/include' -I'D:/C√° nh√¢n/note_book_web/renv/library/windows/R-4.4/x86_64-w64-mingw32/monty/include'   -I\"C:/rtools44/x86_64-w64-mingw32.static.posix/include\"  -DHAVE_INLINE -fopenmp    -O2 -Wall  -mfpmath=sse -msse2 -mstackrealign  -Wall -pedantic -c cpp11.cpp -o cpp11.o\ng++ -std=gnu++17  -I\"C:/PROGRA~1/R/R-44~1.3/include\" -DNDEBUG  -I'D:/C√° nh√¢n/note_book_web/renv/library/windows/R-4.4/x86_64-w64-mingw32/cpp11/include' -I'D:/C√° nh√¢n/note_book_web/renv/library/windows/R-4.4/x86_64-w64-mingw32/dust2/include' -I'D:/C√° nh√¢n/note_book_web/renv/library/windows/R-4.4/x86_64-w64-mingw32/monty/include'   -I\"C:/rtools44/x86_64-w64-mingw32.static.posix/include\"  -DHAVE_INLINE -fopenmp    -O2 -Wall  -mfpmath=sse -msse2 -mstackrealign  -Wall -pedantic -c dust.cpp -o dust.o\ng++ -std=gnu++17 -shared -s -static-libgcc -o odin.systemaa6f1137.dll tmp.def cpp11.o dust.o -fopenmp -LC:/rtools44/x86_64-w64-mingw32.static.posix/lib/x64 -LC:/rtools44/x86_64-w64-mingw32.static.posix/lib -LC:/PROGRA~1/R/R-44~1.3/bin/x64 -lR\ninstalling to C:/Users/ASUS/AppData/Local/Temp/RtmpoDMttt/devtools_install_5b643fad2499/00LOCK-dust_5b64403412ee/00new/odin.systemaa6f1137/libs/x64\n* DONE (odin.systemaa6f1137)\n\n\nCode\npars &lt;- list(schools_time = schools_time, \n             schools_open = schools_open,\n             beta0 = 0.125,\n             beta_1 = 0.25,\n             N = 5e6,\n             I0 = 100)\nsys &lt;- dust_system_create(sis(), pars)\n\ndust_system_set_state_initial(sys)\nt &lt;- seq(0, 600, length.out = 501)\ny &lt;- dust_system_simulate(sys, t)\ny &lt;- dust_unpack_state(sys, y)"
  },
  {
    "objectID": "sea_force.html#compare-2-methods",
    "href": "sea_force.html#compare-2-methods",
    "title": "1¬† Seasonal forcing model",
    "section": "6.2 Compare 2 methods",
    "text": "6.2 Compare 2 methods\nThe choice of functional form used to represent seasonality in the transmission term can have a substantial qualitative, as well as quantitative, dynamical effect\nTwo-dimensional bifurcation figures below show results using a fixed set of initial conditions tend to show more multiennial cycles.\n\n\n\n\n\n\nsinusoidal SEIR-force model\n\n\n\n\n\n\n\ncorrected term-time SEIR-force model\n\n\n\n\n\n\nWith the mean transmission rate fixed at 1,250 per year, the bifurcation from annual to biennial epidemics occurs at a larger amplitude of seasonality for the term-time forcing (\\(b1 \\sim 0.1285\\) compared with \\(\\beta_{1} \\sim 0.0455\\)).\nThe term-time forced models exhibit biennial epidemics for a far larger region of the parameter space with irregular (quasiperiodic or chaotic) outbreaks observed only once b1 exceeds approximately 0.6 (compared to \\(\\beta_{1}\\) &gt; 0.2)\nThe sinusoidal-forced model generates very large amplitude dynamics with the proportion of infectives often falling below \\(10^{-20}\\) when \\(\\beta_{1}\\) is large, term-time forcing the proportion of infectives in the troughs of epidemics always exceeds \\(10^{-10}\\)"
  },
  {
    "objectID": "references.html",
    "href": "references.html",
    "title": "References",
    "section": "",
    "text": "Bailey, Norman TJ. 1975. The Mathematical Theory of Infectious\nDiseases and Its Applications.\n\n\nBartlett, Maurice S. 1956. ‚ÄúDeterministic and Stochastic Models\nfor Recurrent Epidemics.‚Äù In, 4:109. Berkeley.\n\n\nFine, Paul EM, and Jacqueline A Clarkson. 1982. ‚ÄúMeasles in\nEngland and Walesi: An Analysis of Factors Underlying\nSeasonal Patterns.‚Äù International Journal of\nEpidemiology 11 (1): 514.\n\n\nFinkenst√§dt, B√§rbel F, and Bryan T Grenfell. 2000. ‚ÄúTime Series\nModelling of Childhood Diseases: A Dynamical Systems Approach.‚Äù\nJournal of the Royal Statistical Society Series C: Applied\nStatistics 49 (2): 187205.\n\n\nKeeling, Matt J, and Pejman Rohani. 2008. Modeling Infectious\nDiseases in Humans and Animals. Princeton university press.\n\n\nLondon, Wayne P, and James A Yorke. 1973. ‚ÄúRecurrent Outbreaks of\nMeasles, Chickenpox and Mumps: I. Seasonal Variation in Contact\nRates.‚Äù American Journal of Epidemiology 98 (6): 453468.\n\n\nSoper, Herbert E. 1929. ‚ÄúThe Interpretation of Periodicity in\nDisease Prevalence.‚Äù Journal of the Royal Statistical\nSociety 92 (1): 3473."
  },
  {
    "objectID": "sea_force.html#overview",
    "href": "sea_force.html#overview",
    "title": "1¬† Seasonal forcing model",
    "section": "1.1 Overview",
    "text": "1.1 Overview\nAim of this section:\n\nIllustrate the forcing model based on the book Modeling Infectious Diseases in Humans and Animals by Matt Keeling and Pejman Rohani(Keeling and Rohani 2008)\nUnderstanding the mechanisms that generate periodic outbreaks of childhood infectious diseases\nUse odin package to generate the model with time varying transmission rate."
  },
  {
    "objectID": "sea_force.html#historical-background",
    "href": "sea_force.html#historical-background",
    "title": "1¬† Seasonal forcing model",
    "section": "1.2 Historical background",
    "text": "1.2 Historical background\nArthur Ransome settled on changes in the density of susceptibles as the most likely explanation for mechanisms that may generate regular epidemics of measles, whooping cough, and smallpox.\nExanthematous diseases wipe out nearly all susceptibles and, as a consequence, must necessarily wait a number of years before the requisite nearness of susceptible individuals has been again secured.\nCase report data for measles, which conforms well to the assumptions of the SIR model, show large amplitude recurrent epidemics with very dramatic peaks and troughs.\n=&gt; This is in direct contrast to the equilibrium dynamics predicted by simple models, with a steady incidence of disease.\n\n\n1.2.1 Soper study\nFocusing on the monthly case reports for measles in Glasgow from 1905‚Äì1916, (Soper 1929)proceeded to estimate relative transmission rates per month. His methodology centered on the argument that:\n\\[\\frac{cases\\ this\\ interval}{cases\\ last\\ interval} \\sim \\frac {Number\\ of\\ susceptibles\\ now}{Equilibrium\\ number\\ of\\ susceptibles'} \\] which can be expressed as the following equation:\n\\[(\\frac{C_{t+1}}{C_{t}})^{\\alpha}=k_{\\theta}\\frac{X_{t+1}}{X^{*}}\\] Where:\n\n\\(\\alpha\\): realistic infection(the sum of the infectious and latent periods), \\(\\alpha\\) = 0.2\n\\(k_{0}\\): the factor representing the influence of season \\(\\theta\\)\n\\(X_{*}\\): mean number of susceptibles, equivalent to 70 week‚Äôs cases reports\nAt the peak of an epidemic, \\(C_{t+1} \\sim C_{t}\\),we have an initial estimate for \\(X_{t+1}\\), which can be updated by adding the documented births and subtracting the number of cases\n\n=&gt; All that remains now is to fit the seasonality parameter \\(k_{\\theta}\\)\n\n=&gt; Estimated transmission was very low in the summer months, and peaked dramatically in the early autumn (October).\n\n\n1.2.2 London and Yorke study\n(London and Yorke 1973) interested in exploring seasonal influences on transmission, and estimated the mean monthly transmission rates for measles, mumps, and chickenpox in New York City from 1935 to 1972. Key concept:\n\nNumber of susceptibles (\\(X_{p}\\)) has the same value at the peak of every outbreak\nThe number of infectious individuals (Y) has reached its maximum, therefore \\(\\frac{dY}{dt} = 0\\)\n\n\\[\\frac{dY}{dt} = 0 =&gt; \\beta XY/N - \\gamma Y = 0 =&gt; X=X_{p} = \\frac{\\gamma N}{\\beta}\\]\nAt the start of the epidemic year, the number of susceptibles = \\(X_{p}\\) + cumulative number of reported cases for that year.\nThen, by using a discrete-time model, they were able to explore the pattern of transmission rates that provided model exposures consistent with the observed case reports.\n=&gt; They also found a clearly seasonal pattern of transmission for all three diseases, with a peak that coincided with the start of school terms in the autumn and a trough that occurred during the summer months\n\n\n1.2.3 More later studies\nSince then, more mechanistic approaches for the estimation of transmission rates have been developed, which involve a more detailed ‚Äúreconstruction‚Äù of the number of susceptibles in the population.\nFirst (Fine and Clarkson 1982) and later (Finkenst√§dt and Grenfell 2000)used used case report data for measles in England and Wales, together with information on the population size and birth rates to estimate transmission rates.\nüìå A range of statistical approaches have revealed that transmission of childhood infections varies seasonally, peaking at the start of the school year and declining significantly in the summer months."
  },
  {
    "objectID": "sea_force.html#modelling-forcing-in-childhood-infectious-diseases-measles",
    "href": "sea_force.html#modelling-forcing-in-childhood-infectious-diseases-measles",
    "title": "1¬† Seasonal forcing model",
    "section": "1.3 Modelling forcing in childhood infectious diseases: measles",
    "text": "1.3 Modelling forcing in childhood infectious diseases: measles\nThese studies started with the work of (Soper 1929),(Bartlett 1956), and (Bailey 1975), who incorporated seasonality in SIR models with the primary aim of establishing the amplitude of variation in contact rates necessary to produce the observed 80% fluctuation in epidemics.\nIt is often difficult to consider the forcing of childhood infections without considering age structured models. Throughout this chapter, age structure is ignored for simplicity\n(Bailey 1975) explored a simplified SIR model:\n\\[\\frac{dX}{dt} =  \\mu N - \\beta(t) X Y/N \\]\n\\[\\frac{dY}{dt} =  \\beta(t) X Y/N - \\gamma Y \\] where:\n\n\\(\\mu\\) is the per capita birth rate\n\\(\\gamma\\) is the recovery rate from the infection\n\nThe transmission rate is a function of time, Œ≤(t), and was taken by Bailey to be a sinusoid:\n\\[\\beta(t) = \\beta_{0}(1+\\beta_{1}cos(\\omega t))\\]\nwhere:\n\n\\(\\beta_{0}\\): the baseline or average transmission rate\n\\(\\omega\\): the period of the forcing (\\(\\frac {2 \\pi}{time~unit}\\),1 year = \\(\\frac{2 \\pi}{1}\\))\n\\(\\beta_{1}\\): the amplitude of seasonality\n\n\n\nCode\nojsdata = transpose(data)\n\nviewof beta_0 = Inputs.range(\n  [1, 5], \n  {value: 1, step: 1, label: \"beta_0\"}\n)\n\n\nviewof omega = Inputs.radio(\n    [6.28, 4.1867, 3.1400, 2.5120, 2.0933], \n    {value:6.28,label: \"Omega\"})\n\nviewof beta_1 = Inputs.range(\n  [0.5, 5], \n  {value: 0.5, step: 0.5, label: \"beta_1\"}\n)\n\nojsdata_filtered = ojsdata.filter(function(circle){\n  return circle.beta_0 == beta_0 & circle.beta_1 == beta_1 & circle.omega == omega})\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nCode\nPlot.plot({\n  y: {grid: true, label: \"Beta\"},\n  marks: [\n    Plot.lineY(ojsdata_filtered, {x: \"t\", y: \"beta\", stroke: \"steelblue\"}),\n    Plot.lineY(ojsdata_filtered, {x: \"t\", y: \"beta_0\", stroke: \"red\"})\n  ]\n})\n\n\n\n\n\n\n\nTo explore the dynamics of small perturbations to the unforced equilibrium, Bailey made substitutions \\(X = X‚àó(1 + x)\\) and \\(Y = Y ‚àó(1 + y)\\), after omitting some intermediate steps, gives a second order differential equation in the small infectious perturbation y:\n\\[\\frac{d^{2}y}{dt^{2}}+\\mu R_{0} \\frac{dy}{dt}+\\mu \\beta y = -\\beta_{1} \\omega \\gamma sin(\\omega t)\\]\nThe period of the oscillations is the same as the period of the forcing, the amplitude of oscillations (M):\n\\[M = \\beta_{1}\\omega \\gamma \\{(\\mu \\beta_{0}-\\omega^{2})^{2} + (\\omega \\mu R_{0})^{2}\\}^{-\\frac {1}{2}} \\]\nMaking the appropriate substitutions for measles, we set \\(\\frac{1}{\\gamma} = 2\\), \\(\\mu R_{0} \\sim 0.014\\) and \\(\\omega = \\frac{\\pi}{26}\\) (taking the week as our basic time unit) =&gt; \\(M \\sim 7.76 \\beta_{1}\\) ( 10% variation in the transmission parameter translates into seasonal variations of 78% in case notifications)\nButterfly effect: ‚ÄúA butterfly flaps its wings in the Amazon rainforest, and subsequently a hurricane forms in Texas,‚Äù\nüìå Relatively modest levels of variation in the transmission rate can translate into large amplitude fluctuations in the observed disease incidence\n\n1.3.1 Dynamical Consequences of Seasonality: Harmonic and Subharmonic Resonance\nThe first systematic examination of seasonality affecting the dynamical pattern of epidemics was made by Klaus Dietz. Dietz carried out a stability analysis of the familiar SIR model:\n\\[\\frac{dX}{dt} =  \\mu N - (\\beta(t) \\frac {Y}{N} + \\mu) X\\]\n\\[\\frac{dY}{dt} =  \\beta(t) X \\frac {Y}{N} - (\\mu + \\gamma) Y \\]\nwhere \\(\\beta(t) = \\beta_{0}(1-\\beta_{1}cos(\\omega t))\\) ( he used a minus sign in his formulation in order to ensure that contact rates were at their lowest at the start of the epidemic year)\n\n\nCode\ncurve(1*(1 - 0.5*cos(2*pi*time)), 0, 6,\n      n = 1001, xname = \"time\", xlab = \"Time\", ylab = \"Transmission rate\")\n\n\n\n\n\nHe demonstrated that in the absence of seasonal forcing, the system fluctuated with frequency F:\n\\[F^{2} = \\mu (\\gamma + \\mu)(R_{0}-1) - (\\frac{\\mu R_{0}}{2})^{2}\\]\nin many realistic situation \\(\\mu R_{0} \\ll 1\\). Dietz pointed out that for cases in which the natural period of oscillations in the SIR model are approximately the same as that of the seasonal forcing (i.e., F ‚âà œâ), we observe harmonic resonance, where model dynamics mimic those of the forcing, although the amplitude of oscillations may be greatly increased.\nFor different ratios of \\(\\frac {\\omega}{F}\\), however, it is possible for forcing to excite sub-harmonic resonance that gives rise to oscillations with a longer period than the period of the forcing. This phenomenon can occur whenever the natural period of the oscillations \\(\\frac {1}{F}\\) is close to an integer multiple of the period of the forcing \\(\\frac {1}{\\omega}\\)\n\nüìå Forcing is most greatly amplified when the forcing period is close to the natural oscillatory frequency of the unforced dynamics.\n\n\n1.3.2 How the amplitude of seasonality affects dynamics\nChanges in either \\(R_{0}\\) or \\(\\beta_{1}\\) can lead to qualitatively different epidemic patterns:\n\nTop left: \\(R_{0}\\) is large, level of seasonal forcing is small =&gt; fraction of infecteds (small-amplitude annual epidemics)\nMiddle left: \\(\\beta_{1} = 0.1\\) =&gt; we observe subharmonic resonance (as \\(\\omega\\) \\(\\approx\\) 2F), biennial dynamics\nBottom left: a further increase in \\(\\beta_{1}\\) =&gt; four-year cycles\nSecond and third columns: \\(R_{0}\\) is smaller, increases in seasonal amplitude =&gt; do not influence the period of epidemics (remain annual), but alter the magnitude of oscillations\n\n\nüìå In the absence of seasonal forcing, the SIR family of models exhibit a stable equilibrium. The introduction of time-dependent transmission rates can generate a variety of dynamical patterns‚Äîdepending on parameter values‚Äîranging from simple annual epidemics to multiennial outbreaks and eventually chaos."
  },
  {
    "objectID": "sea_force.html#mechanisms-of-multi-annual-cycles",
    "href": "sea_force.html#mechanisms-of-multi-annual-cycles",
    "title": "1¬† Seasonal forcing model",
    "section": "1.4 Mechanisms of Multi-Annual Cycles",
    "text": "1.4 Mechanisms of Multi-Annual Cycles\nThe condition for growth of disease incidence is:\n\\[\\begin{align}\n\\frac {dY}{dt} &= \\beta X \\frac {Y}{N} - (\\gamma + \\mu) Y &gt; 0 \\\\\n&= Y (\\gamma + \\mu) (R_{0}\\frac{X}{N}-1) &gt;0   \\\\\n&\\Rightarrow \\frac{X}{N} &gt;\\frac{1}{R_{0}} \\approx \\frac{\\gamma}{\\beta}\n\\end{align}\\]\nThe spread only occur when a sufficient fraction of susceptible higher a critical value determined by \\(R_{0}\\)\n\n\n\n\n\nTop panel: solid line(weaker forcing used in middle graph), stronger forcing (dashed line used in lower graph)\n\n\n\n\npoint 1: The peak of disease incidence when \\(\\frac{X}{N} &lt; \\frac{\\gamma}{\\beta(t)}\\)\n\\(\\frac{X}{N}\\) continue to decline until the rate of transmission is less than births\npoint 2: \\(\\frac{X}{N} &gt; \\frac{\\gamma}{\\beta(t)}\\) disease incidence rises\nBottom graph, the peak of incidence larger (due to larger beta =&gt; \\(\\frac{X}{N}\\) fall lower and take longer time to replenish the threshold)\npoint 5: the transmission rate is very near its annual maximum (the threshold is near its minimum) =&gt; susceptibles do not remain enough to produce a large epidemic\nThe entire process from point 4 to point 7 takes two years, representing subharmonic resonance\n\n\n\nüìå The amplitude of seasonality increases =&gt; larger epidemics are generated (lower the level of susceptibles such that recovery to above the threshold takes far longer, resulting in longer period cycles)\n\n\n\n\n\nFor \\(\\beta &gt; 0.0455\\), we observed two dots =&gt; the dynamic are biennial and repeat every two years\nFor \\(\\beta &gt; 0.3\\), dynamics are largely chaotic with occasional ‚Äúwindows‚Äù"
  },
  {
    "objectID": "sea_force.html#forcing-function",
    "href": "sea_force.html#forcing-function",
    "title": "1¬† Seasonal forcing model",
    "section": "1.5 Forcing function",
    "text": "1.5 Forcing function\nWe‚Äôve explored seasonality by assuming that the transmission rate is time dependent and specifically is determined by a simple sinusoidal function, this view has changed in recent years:\n\nseasonally forced models of childhood infections now more often use a square wave\nthe transmission rate is assumed to be high during school terms and low at other times\n\n\\[\\beta(t)=\\beta_{0}(1+b_{1}Term(t))\\]\nwhere:\n\n\\(Term(t)\\) is +1 during the school term and ‚àí1 at other times.\n\\(b_{1}\\) to represent the amplitude of seasonality\n\n\n\nTable¬†1.1: Timings of the major school holidays when Term = ‚àí1; during all other times Term = +1.\n\n\nHoliday\nModel days\nCalender dates\n\n\n\n\nChirstmas\n356-6\nDecember 21 - January 6\n\n\nEaster\n100-115\nApril 10-25\n\n\nSummer\n200-251\nJuly 19 - September 8\n\n\nAutumn Half Term\n300-307\nOctober 27-November 3\n\n\n\n\nWe obtain 92 school holidays , 273 days of school =&gt; many more ‚Äú+1‚Äù days than ‚Äú‚àí1‚Äù days =&gt; give rise to a mean transmission rate averaged over the year. To ensure R0 is constant irrespective of the precise forcing function used and the amplitude of seasonality. If there are \\(D+\\) days of school and \\(D‚àí\\) holidays, then our forcing function would be:\n\\[\\beta(t)=\\frac{\\beta_{0}}{\\frac{1}{365}((1+b_{1})D_{+}+(1-b_{1})D_{-})}(1+b_{1}Term(t))\\]\n\n\nCode\nlibrary(odin2)\nlibrary(dust2)\nlibrary(tidyverse)\nlibrary(latex2exp)\n\nbeta_0 &lt;- 1250\nbeta_1 &lt;- 0.25\nt &lt;- seq(0,365,le = 1001)\n\n## sinusoidal function\nomega &lt;- (2*pi)/365\nbeta_sin_func &lt;- data.frame(x = t,\n                            y = beta_0*(1 + beta_1*cos(omega*t)))\n\n## term time tranmission function\n\nschools_time &lt;- c(0, 7, 100, 116, 200, 252, 300,308,356)\nschools_open &lt;- c(-1, 1, -1, 1,   -1,   1,   -1, 1,-1)\n\nbeta &lt;- approx(\n  schools_time,\n  beta_0*(1 + beta_1*schools_open),\n  xout = t,\n  method = \"constant\",\n  rule = 2)\n\n## correct term time tranmission function\nmean_beta &lt;- 1/365*((1+beta_1)*273+(1-beta_1)*92)\n\nbeta_correct &lt;- approx(\n  schools_time,\n  beta_0/mean_beta*(1 + beta_1*schools_open),\n  xout = t,\n  method = \"constant\",\n  rule = 2)\n\n\n\n\n\n\n\n\n1.5.1 Seasonal forcing model with odin2\n\n\nCode\nschools_time &lt;- c(0, 7, 100, 116, 200, 252, 300,308,356)\nschools_open &lt;- c(-1, 1, -1, 1,   -1,   1,   -1, 1,-1)\n\nsis &lt;- odin({\n    deriv(S) &lt;- -beta * I * S / N + gamma * I\n    deriv(I) &lt;-  beta * I * S / N - gamma * I\n    deriv(trans_rate) &lt;-  beta \n    \n    initial(S) &lt;- N - I0\n    initial(I) &lt;- I0\n    initial(trans_rate) &lt;-  beta \n    \n    I0 &lt;- parameter(10)\n    N &lt;- parameter(1000)\n    schools &lt;- interpolate(schools_time, schools_open, \"constant\")\n    schools_time &lt;- parameter(constant = TRUE)\n    schools_open &lt;- parameter(constant = TRUE)\n    dim(schools_time, schools_open) &lt;- parameter(rank = 1)\n    beta0 &lt;- parameter(0.125)\n    beta_1 &lt;- parameter(0.025)\n    beta &lt;- beta0*(1 + beta_1*schools)\n    gamma &lt;- 0.1\n})\n\n\n‚îÄ‚îÄ R CMD INSTALL ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\n* installing *source* package 'odin.systemaa6f1137' ...\n** using staged installation\n** libs\nusing C++ compiler: 'G__~1.EXE (GCC) 13.2.0'\ng++ -std=gnu++17  -I\"C:/PROGRA~1/R/R-44~1.3/include\" -DNDEBUG  -I'D:/C√° nh√¢n/note_book_web/renv/library/windows/R-4.4/x86_64-w64-mingw32/cpp11/include' -I'D:/C√° nh√¢n/note_book_web/renv/library/windows/R-4.4/x86_64-w64-mingw32/dust2/include' -I'D:/C√° nh√¢n/note_book_web/renv/library/windows/R-4.4/x86_64-w64-mingw32/monty/include'   -I\"C:/rtools44/x86_64-w64-mingw32.static.posix/include\"  -DHAVE_INLINE -fopenmp    -O2 -Wall  -mfpmath=sse -msse2 -mstackrealign  -Wall -pedantic -c cpp11.cpp -o cpp11.o\ng++ -std=gnu++17  -I\"C:/PROGRA~1/R/R-44~1.3/include\" -DNDEBUG  -I'D:/C√° nh√¢n/note_book_web/renv/library/windows/R-4.4/x86_64-w64-mingw32/cpp11/include' -I'D:/C√° nh√¢n/note_book_web/renv/library/windows/R-4.4/x86_64-w64-mingw32/dust2/include' -I'D:/C√° nh√¢n/note_book_web/renv/library/windows/R-4.4/x86_64-w64-mingw32/monty/include'   -I\"C:/rtools44/x86_64-w64-mingw32.static.posix/include\"  -DHAVE_INLINE -fopenmp    -O2 -Wall  -mfpmath=sse -msse2 -mstackrealign  -Wall -pedantic -c dust.cpp -o dust.o\ng++ -std=gnu++17 -shared -s -static-libgcc -o odin.systemaa6f1137.dll tmp.def cpp11.o dust.o -fopenmp -LC:/rtools44/x86_64-w64-mingw32.static.posix/lib/x64 -LC:/rtools44/x86_64-w64-mingw32.static.posix/lib -LC:/PROGRA~1/R/R-44~1.3/bin/x64 -lR\ninstalling to C:/Users/ASUS/AppData/Local/Temp/RtmpOQSFlm/devtools_install_2b3c182e2ac6/00LOCK-dust_2b3c4e0e416c/00new/odin.systemaa6f1137/libs/x64\n* DONE (odin.systemaa6f1137)\n\n\nCode\npars &lt;- list(schools_time = schools_time, \n             schools_open = schools_open,\n             beta0 = 0.125,\n             beta_1 = 0.25,\n             N = 5e6,\n             I0 = 100)\nsys &lt;- dust_system_create(sis(), pars)\n\ndust_system_set_state_initial(sys)\nt &lt;- seq(0, 600, length.out = 501)\ny &lt;- dust_system_simulate(sys, t)\ny &lt;- dust_unpack_state(sys, y)\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n1.5.2 Compare 2 methods\nThe choice of functional form used to represent seasonality in the transmission term can have a substantial qualitative, as well as quantitative, dynamical effect\nTwo-dimensional bifurcation figures below show results using a fixed set of initial conditions tend to show more multiennial cycles.\n\n\n\n\n\n\nsinusoidal SEIR-force model\n\n\n\n\n\n\n\ncorrected term-time SEIR-force model\n\n\n\n\n\n\nWith the mean transmission rate fixed at 1,250 per year, the bifurcation from annual to biennial epidemics occurs at a larger amplitude of seasonality for the term-time forcing (\\(b1 \\sim 0.1285\\) compared with \\(\\beta_{1} \\sim 0.0455\\)).\nThe term-time forced models exhibit biennial epidemics for a far larger region of the parameter space with irregular (quasiperiodic or chaotic) outbreaks observed only once b1 exceeds approximately 0.6 (compared to \\(\\beta_{1}\\) &gt; 0.2)\nThe sinusoidal-forced model generates very large amplitude dynamics with the proportion of infectives often falling below \\(10^{-20}\\) when \\(\\beta_{1}\\) is large, term-time forcing the proportion of infectives in the troughs of epidemics always exceeds \\(10^{-10}\\)"
  },
  {
    "objectID": "sea_force.html#conclusion",
    "href": "sea_force.html#conclusion",
    "title": "1¬† Seasonal forcing model",
    "section": "1.6 Conclusion",
    "text": "1.6 Conclusion\n\n\n\nGray line: measles data and standard error, black-solid: sinusoidal, dotted line: corrected term forced model\n\n\n\n\n\nSeasonal forcing\nTerm time\nSinusoidal\n\n\n\n\nBest fit\n\\(b_{1} = 0.29\\)\n\\(beta_{1} = 0.11\\)\n\n\nAssociated error\n\\(E_{v} = 1.18\\)\n\\(beta_{1} = 0.64\\)\n\n\n\n\nThe best-fit model with sinusoidal forcing results in a lower error because it more accurately captures the timing of the epidemic peak.\nThe best-fit model with term-time forcing generates an epidemic peak that is slightly delayed, even though it captures more of the qualitative properties of the biennial cycle.\n\nüìå This discrepancy highlights the need for extra biological detail: A more realistic distribution for the latent and infectious periods or including age structure greatly reduces the error associated with term-time forcing.\n\n\n\n\nBailey, Norman TJ. 1975. The Mathematical Theory of Infectious Diseases and Its Applications.\n\n\nBartlett, Maurice S. 1956. ‚ÄúDeterministic and Stochastic Models for Recurrent Epidemics.‚Äù In, 4:109. Berkeley.\n\n\nFine, Paul EM, and Jacqueline A Clarkson. 1982. ‚ÄúMeasles in England and Walesi: An Analysis of Factors Underlying Seasonal Patterns.‚Äù International Journal of Epidemiology 11 (1): 514.\n\n\nFinkenst√§dt, B√§rbel F, and Bryan T Grenfell. 2000. ‚ÄúTime Series Modelling of Childhood Diseases: A Dynamical Systems Approach.‚Äù Journal of the Royal Statistical Society Series C: Applied Statistics 49 (2): 187205.\n\n\nKeeling, Matt J, and Pejman Rohani. 2008. Modeling Infectious Diseases in Humans and Animals. Princeton university press.\n\n\nLondon, Wayne P, and James A Yorke. 1973. ‚ÄúRecurrent Outbreaks of Measles, Chickenpox and Mumps: I. Seasonal Variation in Contact Rates.‚Äù American Journal of Epidemiology 98 (6): 453468.\n\n\nSoper, Herbert E. 1929. ‚ÄúThe Interpretation of Periodicity in Disease Prevalence.‚Äù Journal of the Royal Statistical Society 92 (1): 3473."
  }
]